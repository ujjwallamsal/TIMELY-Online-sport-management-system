import{c as w,e as F,g as L,h as T,r as p,y as A,w as V,x as I,j as e,C as N}from"./index-BzJ6QfSi.js";import{u as U,o as z,s as $,n as m}from"./useForm-CAIEg1RM.js";import{F as B,b as M,a as x,I as h,c as P,B as r}from"./Form-DKyzaUtQ.js";import{A as q}from"./arrow-left-BlSRFXVp.js";import{S as D}from"./save-4iA0hoND.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],O=w("lock-open",G);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],b=w("lock",H),Y=()=>{const{eventId:i}=F(),u=L(),{showSuccess:c,showError:_}=T(),[n,o]=p.useState(null),[j,y]=p.useState(new Set),{data:d,isLoading:R,refetch:k}=A(parseInt(i||"0")),f=V(),S=I(),a=U({initialValues:{fixture_id:0,home_score:0,away_score:0,notes:""},validationSchema:z({fixture_id:m().min(1,"Please select a fixture"),home_score:m().min(0,"Score must be non-negative"),away_score:m().min(0,"Score must be non-negative"),notes:$().optional()}),onSubmit:async s=>{try{n?(await S.mutateAsync({id:n,...s}),c("Result Updated","The result has been updated successfully.")):(await f.mutateAsync(s),c("Result Recorded","The result has been recorded successfully.")),o(null),a.reset(),k()}catch{_("Error","Failed to save result. Please try again.")}}}),g=s=>{j.has(s.id)||(o(s.id),a.setValues({fixture_id:s.id,home_score:s.result?.home_score||0,away_score:s.result?.away_score||0,notes:s.result?.notes||""}))},C=s=>{y(t=>new Set(t).add(s)),c("Result Locked","This result has been locked and cannot be modified.")},E=s=>{y(t=>{const l=new Set(t);return l.delete(s),l}),c("Result Unlocked","This result can now be modified.")};return R?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,t)=>e.jsx("div",{className:"h-20 bg-gray-200 rounded"},t))})]})})}):!d||d.results?.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Fixtures Found"}),e.jsx("p",{className:"text-gray-500",children:"No fixtures have been generated for this event yet."}),e.jsx("button",{onClick:()=>u(`/events/${i}/fixtures/generate`),className:"mt-4 btn btn-primary",children:"Generate Fixtures"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>u(`/events/${i}`),className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Back to Event"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Results Entry"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Enter and manage match results for this event"})]})]})})}),n&&e.jsxs("div",{className:"card mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:n?"Edit Result":"Record Result"}),e.jsxs(B,{onSubmit:a.handleSubmit,children:[e.jsxs(M,{children:[e.jsx(x,{children:e.jsx(h,{label:"Home Team Score",name:"home_score",type:"number",min:"0",value:a.values.home_score,onChange:s=>a.setValue("home_score",parseInt(s.target.value)||0),error:a.errors.home_score,required:!0})}),e.jsx(x,{children:e.jsx(h,{label:"Away Team Score",name:"away_score",type:"number",min:"0",value:a.values.away_score,onChange:s=>a.setValue("away_score",parseInt(s.target.value)||0),error:a.errors.away_score,required:!0})})]}),e.jsx(x,{children:e.jsx(h,{label:"Notes (Optional)",name:"notes",value:a.values.notes,onChange:s=>a.setValue("notes",s.target.value),error:a.errors.notes,placeholder:"Additional notes about the match"})}),e.jsxs(P,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>{o(null),a.reset()},children:"Cancel"}),e.jsxs(r,{type:"submit",loading:a.isSubmitting,disabled:!a.isValid||a.isSubmitting,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),n?"Update Result":"Save Result"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Event Fixtures"}),e.jsx("div",{className:"grid gap-4",children:d.results?.map(s=>{const t=s.result,l=j.has(s.id),v=n===s.id;return e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:s.home_team_name||`Team ${s.home_team}`}),e.jsx("div",{className:"text-gray-500",children:"vs"}),e.jsx("div",{className:"text-lg font-medium text-gray-900",children:s.away_team_name||`Team ${s.away_team}`})]}),t&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[s.result?.home_score," - ",s.result?.away_score]}),l&&e.jsx(b,{className:"h-5 w-5 text-red-500"})]})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Fixture #",s.id]}),s.scheduled_date&&e.jsx("span",{className:"ml-4",children:new Date(s.scheduled_date).toLocaleDateString()})]}),t&&s.result?.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",s.result.notes]})]})})}),e.jsx("div",{className:"flex items-center space-x-2 ml-4",children:t?e.jsxs(e.Fragment,{children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>g(s),disabled:v,children:"Edit"}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>C(s.result?.id),children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Lock"]})]}),l&&e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>E(s.result?.id),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Unlock"]})]}):e.jsxs(r,{size:"sm",onClick:()=>g(s),disabled:v,children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Record Result"]})})]})},s.id)})})]})]})})};export{Y as default};
